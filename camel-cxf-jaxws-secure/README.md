Camel Secure CXF JAX-WS
------------------------

This example demonstrates using the camel-cxf component with Red Hat Fuse on EAP to produce and consume JAX-WS web
services secured by an Elytron Security Domain. Elytron is a new security framework available since _Red Hat JBoss EAP 7.1_.

In this example, a Camel route takes a message payload from a direct endpoint and passes it on to a CXF producer
endpoint. The producer uses the payload to pass arguments to a CXF JAX-WS web service that is secured by _BASIC HTTP
authentication_.

Moreover, all the exchanged SOAP messages are *signed and encrypted* according to the _X509 signature and encryption
WS-security policy_:
* The `directToCxfBeanRoute` route signs and encrypts the SOAP request payload using its private key when calling the SOAP service exposed by the `cxfConsumerToProcessorRoute` route
* On reception of the SOAP request, the `cxfConsumerToProcessorRoute` route verifies and decrypts the SOAP request payload using the `directToCxfBeanRoute` public key
* At the end, the `cxfConsumerToProcessorRoute` route signs and encrypts the SOAP response using its own private key, and sends it back to the `directToCxfBeanRoute` route. In the same way,
the latter verifies and decrypts the SOAP response using the `cxfConsumerToProcessorRoute` route public key.

The full Camel route can be seen in [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml).

Prerequisites
-------------

* _Apache Maven 3.5+_
* _Red Hat JBoss EAP 7.1_ server with _Red Hat Fuse 7.2_ installed
* JKS keystores used to enforce the X509 signature and encryption WS-security policy on both the SOAP client and server:
  * `src/main/resources/certs/client-ws-x509signature.ks`: keystore for the CXF Producer (_Web service client_. See [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml)). It contains the client private key.
  * `src/main/resources/certs/client-ws-x509signature.ts`: truststore for the CXF Producer (_Web service client_. See [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml)). It contains the service public key.
  * `src/main/resources/certs/service-ws-x509signature.ks`: keystore for the CXF Consumer (_Web service server_. See [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml)). It contains the service private key.
  * `src/main/resources/certs/service-ws-x509signature.ts`: truststore for the CXF Consumer (_Web service server_. See [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml)). It contains the client public key.
  * This is how the above JKS keystores were generated):
  ```
  # Generate an auto-signed key pair and a JKS keystore for the client 
  keytool -genkeypair -keyalg RSA -keysize 4096 -validity 1825 -dname "CN=client-ws-x509signature" -alias client-privatekey -keystore client-ws-x509signature.ks
  # Export the client public key
  keytool -export -alias client-privatekey -file client-pubkey.crt -keystore client-ws-x509signature.ks
  # Generate an auto-signed key pair and a JKS keystore for the service
  keytool -genkeypair -keyalg RSA -keysize 4096 -validity 1825 -dname "CN=service-ws-x509signature" -alias service-privatekey -keystore service-ws-x509signature.ks
  # Export the service public key
  keytool -export -alias service-privatekey -file service-pubkey.crt -keystore service-ws-x509signature.ks
  # Import the client public key in the service truststore (JKS keystore)
  keytool -import -trustcacerts -file client-pubkey.crt -alias client-pubkey -keystore service-ws-x509signature.ts
  # Import the service public key in the client truststore (JKS keystore)
  keytool -import -trustcacerts -file service-pubkey.crt -alias service-pubkey -keystore client-ws-x509signature.ts
  ```
    * the overall password used is : `changeit`

Running the example
-------------------

To run the example.

1. Use the add-user script to create a new server application user and group

    For Linux:

    `${JBOSS_HOME}/bin/add-user.sh -a -u testUser -p testPassword1+ -g testRole`

    For Windows:

   `%JBOSS_HOME%\bin\add-user.bat -a -u testUser -p testPassword1+ -g testRole`

2. Start the application server in standalone mode:

    For Linux:

    `${JBOSS_HOME}/bin/standalone.sh -c standalone-full.xml`

    For Windows:

    `%JBOSS_HOME%\bin\standalone.bat -c standalone-full.xml`

3. Set the Security Domain using a JBoss CLI script.

    For Linux:

    `${JBOSS_HOME}/bin/jboss-cli.sh --connect --file=configure-basic-security.cli`

    For Windows:

    `%JBOSS_HOME%\bin\jboss-cli.bat --connect --file=configure-basic-security.cli`

4. Study `jboss-web-xml` and `web.xml` files in `webapp/WEB-INF` directory of this project. They
set the application security domain, security roles and constraints.

5. Build and deploy the project `mvn install -Pdeploy`

6. Browse to _http://*<jboss\_eap\_host>*:8080/example-camel-cxf-jaxws-secure/_

You should see a page titled 'Send A Greeting'. This UI enables us to interact with the test 'greeting' web service which will have also been started.

Testing Camel Secure CXF JAX-WS
-------------------------------

Web UI
------

Browse to _http://*<jboss\_eap\_host>*:8080/example-camel-cxf-jaxws-secure/_.

From the 'Send A Greeting' web form, enter a 'message' and 'name' into the text fields and press the 'send' button. You'll then see the information you entered combined to display a greeting on the UI.

`CamelCxfWsServlet` handles the POST request from the web UI. It retrieves the message and name form parameter values and constructs an object array. This object array will be the message payload that is sent to the `direct:start` endpoint. A `ProducerTemplate` sends the message payload to Camel. `The direct:start` endpoint passes the object array to a `cxf:bean` web service producer. The web service response is used by `CamelCxfWsServlet` to display the greeting on the web UI.

The full Camel route can be seen in [_*cxfws-security-camel-context.xml*_](src/main/webapp/WEB-INF/cxfws-security-camel-context.xml).

* WebUI screenshot:
![webUI_camel-cxf-jaxws-secure](../images/webUI_camel-cxf-jaxws-secure.png)

* _Red Hat JBoss EAP 7.1.5_ log extracts to show the X509 signed and encrypted SOAP envelopes:
```
2018-12-20 23:06:53,980 INFO  [directToCxfBeanRoute] (default task-8) Received direct message: [Ljava.lang.Object;@3f72f74e
2018-12-20 23:06:54,102 INFO  [org.apache.cxf.services.GreetingServiceService.greetingPort.greeting] (default task-8) Outbound Message
---------------------------
ID: 27
Address: http://fuse-eap-01.lab.com:8080/webservices/greeting-security-basic
Encoding: UTF-8
Http-Method: POST
Content-Type: text/xml
Headers: {Accept=[*/*], Authorization=[Basic dGVzdFVzZXI6dGVzdFBhc3N3b3JkMSs=], breadcrumbId=[ID-amq-standalone-lab-com-1545323307183-21-1], SOAPAction=["urn:greet"]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Header><wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" soap:mustUnderstand="1"><xenc:EncryptedKey xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference><ds:X509Data><ds:X509IssuerSerial><ds:X509IssuerName>CN=service-ws-x509signature</ds:X509IssuerName><ds:X509SerialNumber>212833955</ds:X509SerialNumber></ds:X509IssuerSerial></ds:X509Data></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>fDrOJqqlOc+E1Rfr+FNcjXaNPJN0EXIfCECzS8qDqZ4F5PfTatf0JGYWtYWGHdYoDXaZECxMcOac0AkLUG7y9m9UhHPRWoqUESztK6rtgxOLNV3THh9x2wlT8kV5nvtHFOZ3ojs1ALOA7DJ4LTGvSFxrC9O+R5xQ82TSO1i8EAp4A3RlDX9/cYXhDRRHa+xmXNvb+rDyElvjURv4RgcRRVr1p40Pu9wgMmzSSHlIMUQr91WFFOJzX42Tg4QClpX5GPoKwThyETz7pGC7OHdyGahvGQdEfinQkoNDeCmmw7Xm6Oa2sr/lXw4b4aZBFKEmrY6petVnnwCLusDmGZEc+/ptTEvfAoi2gS8fBs5rF9usL99dc6LSIRm+WLDkColPfInlaQtx//723tA0zl2W2VY67Z0ZGy7wvHMZJIgGu5CdTuo1ShSiWiH4mBOB5KEIi3nj1oq9qE1jTx06V2XWCthHiTDR9Aqvw6vWLfiMJaog+EfT55OkQcpiIPZlchYytF1jiHMKSm/QNDttDLF0qNdt62qyd8n76fb4ybQGTN7gIZHVuQgLmVBGRGp4lvnR00dr0L9Ewq3ybN+x8gTL5F9qQKjhJyO5Ec6wheUDHRwsaIiNulhZeJZOafwZ+OPECeTEpvDsF3pzv1SXq5p4KMP8USu5mw8r0XecgfbngdQ=</xenc:CipherValue></xenc:CipherData><xenc:ReferenceList><xenc:DataReference URI="#ED-fcc7dbb8-3a2c-4823-bf3f-7166290f3092"/><xenc:DataReference URI="#ED-fd9d7f5c-fdb0-4e73-afc7-ef28ff22f337"/></xenc:ReferenceList></xenc:EncryptedKey><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-fcc7dbb8-3a2c-4823-bf3f-7166290f3092" Type="http://www.w3.org/2001/04/xmlenc#Element"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>rhfkWI3QzfaAR+vXnvflpvsXFtdFp1YJ7qtR7XE+H+lrY3GuR/r3yMTQ9k/ll1UmHTq3+0KVSTwKlFa7kPW5qAP4H8NuWcvfPETdhp48s5sci1jzKUtTJHq12W1X1hoxz3DCDn4wff1X+si6910sdUqz9mEPKEtn8AQVFf0985F2VJVX7A3ZvAI6Y7c2v+i850Es9/G43ELA63K3OMrd7ZwoymEXoOz958c1vp8pZXTuzgbOV73z/NbzTSCFGn88mnUp6xGdwGUi7ghAkB75zyd/rpq4C1lIYhknPedbUz1OIMC6DYw1dLKgNQ8kmknbWfsFPVJrYdjZXnTGrh4L5ZiXKlWiXCUkqAcj6zdSsX0EGVax63xX3fuv2mAcafTbWlOeChh7a46d0HSk1H+7tdvlHU/pOEJ4wZWzOj57hnUbqOrH/4CpRGPAZIwF5AH6pffySOCh9SARC0DimGODR1HV8HnR0fCZit1p4PPnhHPx5GwMj6Qx9NEbt83BfbS89+KVdQsMTmBH/Y1r6x/LLOZLe5JM8EeYcMInupaSfKak1PlN+7SfKCGK796HLfIuwBbgqhLF8PyE16twBNBpk6ndqmuhPsSBz4/HJ3Qb358qiMRhfpcyrTVkH0HQ3o+ldUjCgaEJMgzrtPTI0dOlTJNNGD9oWGbDAdsaGOTIH+siN44U+NCrbrYlHr6JpRre69tnTh3AeIWnT2Z+2YIYXUB5qQR1yRpv1Sw79Bkx8DmsuKH2AG6f0T3G89DzcGEnI23Zx9xbAX/YNFNJGBgCtJp/kjdWvTH9KwNmaalbSs2QeB+D84lnvRDslfyK/fEXbXj9FVr9ggDyPRN7YRmKP8ogne3oVZqf7j22Wc70T4G+qlE+OfW/iAkleA0nmqu0ZZ2RKrpoRa3n0qiXDuufxqeEU7DOSf/IUpiLL7v6quktng0WG/M7Dwlg2LGmj0/HdNP0KcgTQXUKD3nvRKX4adUxt5cw0qpx69/u1CdxK7P/BOo3Zl/wox6aiVKhh5MXZ67sZNsHULEr/gIYXxs8oZIO/dnq/aDZR+1TKAsbWupUt4p4dVA2nKNBYezrmWdQlgsGf3vRG3MS35Nwe7fc3mgrRkD3rirpIq3WoHKhWjy6AziLkgJo2xc0czIvUazyTN87QQ26tOocDD2NqHyYWlZR4udd6OIQwSXNYNMM0C9EW/jB6oLSSmCc60TvgJL7ViTgCWb3HZx6CP4GbLR/RZeFxWwdtgv+Na/d8IHSkGE8D+N0/0cLobI47rQJP9Vj9qfa14LmQmIeeJGVgcaMdozuupngMSLw6qGzsHVnDkMjPqcKiA8qtHpobs/i3fc8cm6+oOYANrFaHDjvtQYCCPpdAYtWNSq/lzd6YiqRns3FCx1DUBQTgUxUy8UFy5Rl+tE+7GNmM0g4FNTLHXqhVcVdkdB7hndc+KnUVr82fXgxQQRVCihCbA04KN0Nk7qdPwP4VPBXZ0hxlf3aeeXeMbOrPMbAjKDUkpPsJoEOHObZ25r6GhpJFE/YA8RrtCx2H4WzD6rFeuDNmReLOGqYyqUDsoW0Mu/9AZdZOtT6tm10seHI5HQgvTqH55KnMlJAyskc8wp9ii61X9oPW7OaJJiVB3OXNsXe+kMpX9wo6StO2pj0W/BBa++kTJ9ZPW2wLMeEAvaUsi09ApTBYPodJlhLzRETHM2ZBC8ycpV20TJHf2iAvCNt8LetxGJSVKc2tZewK3XQfqHXNIHZUjdd84p5qcDV7+TCJbyDgmwtrvX02goJfOTW1/GqqQ02GxcL1v3Vz0bUzYOJignKkBdu86WYhbvW3FkL5+ME6nPXzyTyxtgBqHffxCuCClsgESPkcTb9iLVtzGjai3Y9G13W30pJ8Obtjc78ZKiGEXRzQ0/zAa3NsDV/xqgxPSBfM8OmWu6yGCo9btqQV16EIxUj1LmStv1QrJimXSnSqVMqAn2wnBNU5OzQJe6NGqsWD8dqT97MHSuZ+ZIGTQfFgtDXGHz9kr5wWXVs1Pf7AgU3YC3ys87/gUOClf6ZDwj3PLW9uXWxPoFfnZ803bwj/1X1aj/jQCnRaE812AAaiLlMsOyg4wpH+1FavV8kEHoSzam/ZpPxJcAvT5CvYlbUm0/aEPN3AGTq6o77Fju0oEexd/jZ1hwj2k1oY7XkUFWOpvTSSYF/YqeOhl2jbjE4ULA6hdPqxD+0SudS9+XPVtfdzI5znvJW5M3EiRI7hYhRQz7Uq2byENU3PMhvru7tSJaJPwgJfyLeup17iDRITNDOsUA5KAcYJhMYzXgtLSHzdVNvuzPTN73QPLyfiYTY87OpqtXOoZDSrmaEPEDdMUQhSYUq5ppkZVBb7ysssa6YJYVNormjwkIsJmOibhaWQBkpTIo+HIkHzXdcG2jV7M+EprGmFJwRabOCY8mxUVFTndyCPBs3zTDqym9jfGig/j6falvcYLyVRmdh6raicCfa5ynglb/Be+OtY1AObyo2l/dkFElEYMQ6h/NurNl8u9prMQEIIYTflmmL+3EpxeUJB64J+4KVZa6d1hNouIxplU20HFS/jgYYOnwMZEPMyrSx07IxMdNmyGL+OBYEIKQauHRteHoC/szN9jEVeZKBGNjtY/yLSq5uRW712yozOo+h0RePx4nfKETd0mG7Oop2/o7FaIopUJc5nr2q7XmwK7hwjYx8B/B0BFd/dZK26BkPBelMuLiuXqFClvDP0rqe5enzN2qgS2jjtA1ACmyQOKKQpWYTexrIJhmPhRqxvL9l45ayH7xHzcONDNoVtRpVN9w=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></wsse:Security></soap:Header><soap:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="id-12c1fe83-1545-4b45-b928-6aeb2920e04f"><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-fd9d7f5c-fdb0-4e73-afc7-ef28ff22f337" Type="http://www.w3.org/2001/04/xmlenc#Content"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>S/SkozokySBORzHAvAQlOZwN+5HEmSrNXbU7Hke4p0lMZ5+kGbHgQTgV4wvWwZ6W1vSL0kUrNjGQDmkumdzSXH7/f6wuTFDuwzZYPfogGX8RjZ/qpL5YpuHQNdVhxpbaSSQBJX4A+w8DgIwitpiYiK20j5XbS7QGx68YSdzaxrxWwKW12fwBd3jD2fZXfuymnxMnfhM1qoTKJjvU44H1nFn7Nk270sVsglupYfJy4c9qlp0SV1sE46Ci5+TKf6/VbY3YO2B/wdCAffMVokF9V+m/wd3mgZRBdRft9uEfdDU=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></soap:Body></soap:Envelope>
--------------------------------------
2018-12-20 23:06:54,140 WARNING [javax.faces] (default task-9) Multiple JSF Applications found on same ClassLoader.  Unable to safely determine which FactoryManager instance to use. Defaulting to first match.
2018-12-20 23:06:54,140 WARNING [javax.faces] (default task-9) Multiple JSF Applications found on same ClassLoader.  Unable to safely determine which FactoryManager instance to use. Defaulting to first match.
2018-12-20 23:06:54,147 INFO  [org.apache.cxf.services.GreetingServiceService.greetingPort.greeting] (default task-9) Inbound Message
----------------------------
ID: 28
Address: http://fuse-eap-01.lab.com:8080/webservices/greeting-security-basic
Encoding: UTF-8
Http-Method: POST
Content-Type: text/xml; charset=UTF-8
Headers: {Accept=[*/*], Authorization=[Basic dGVzdFVzZXI6dGVzdFBhc3N3b3JkMSs=], breadcrumbId=[ID-amq-standalone-lab-com-1545323307183-21-1], connection=[Keep-Alive], content-type=[text/xml; charset=UTF-8], Host=[fuse-eap-01.lab.com:8080], SOAPAction=["urn:greet"], transfer-encoding=[chunked], User-Agent=[Apache CXF 3.1.16.redhat-1]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Header><wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" soap:mustUnderstand="1"><xenc:EncryptedKey xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference><ds:X509Data><ds:X509IssuerSerial><ds:X509IssuerName>CN=service-ws-x509signature</ds:X509IssuerName><ds:X509SerialNumber>212833955</ds:X509SerialNumber></ds:X509IssuerSerial></ds:X509Data></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>fDrOJqqlOc+E1Rfr+FNcjXaNPJN0EXIfCECzS8qDqZ4F5PfTatf0JGYWtYWGHdYoDXaZECxMcOac0AkLUG7y9m9UhHPRWoqUESztK6rtgxOLNV3THh9x2wlT8kV5nvtHFOZ3ojs1ALOA7DJ4LTGvSFxrC9O+R5xQ82TSO1i8EAp4A3RlDX9/cYXhDRRHa+xmXNvb+rDyElvjURv4RgcRRVr1p40Pu9wgMmzSSHlIMUQr91WFFOJzX42Tg4QClpX5GPoKwThyETz7pGC7OHdyGahvGQdEfinQkoNDeCmmw7Xm6Oa2sr/lXw4b4aZBFKEmrY6petVnnwCLusDmGZEc+/ptTEvfAoi2gS8fBs5rF9usL99dc6LSIRm+WLDkColPfInlaQtx//723tA0zl2W2VY67Z0ZGy7wvHMZJIgGu5CdTuo1ShSiWiH4mBOB5KEIi3nj1oq9qE1jTx06V2XWCthHiTDR9Aqvw6vWLfiMJaog+EfT55OkQcpiIPZlchYytF1jiHMKSm/QNDttDLF0qNdt62qyd8n76fb4ybQGTN7gIZHVuQgLmVBGRGp4lvnR00dr0L9Ewq3ybN+x8gTL5F9qQKjhJyO5Ec6wheUDHRwsaIiNulhZeJZOafwZ+OPECeTEpvDsF3pzv1SXq5p4KMP8USu5mw8r0XecgfbngdQ=</xenc:CipherValue></xenc:CipherData><xenc:ReferenceList><xenc:DataReference URI="#ED-fcc7dbb8-3a2c-4823-bf3f-7166290f3092"/><xenc:DataReference URI="#ED-fd9d7f5c-fdb0-4e73-afc7-ef28ff22f337"/></xenc:ReferenceList></xenc:EncryptedKey><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-fcc7dbb8-3a2c-4823-bf3f-7166290f3092" Type="http://www.w3.org/2001/04/xmlenc#Element"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>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</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></wsse:Security></soap:Header><soap:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="id-12c1fe83-1545-4b45-b928-6aeb2920e04f"><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-fd9d7f5c-fdb0-4e73-afc7-ef28ff22f337" Type="http://www.w3.org/2001/04/xmlenc#Content"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-c8ded17e-6f55-4ed1-8786-5b11fed7b124"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>S/SkozokySBORzHAvAQlOZwN+5HEmSrNXbU7Hke4p0lMZ5+kGbHgQTgV4wvWwZ6W1vSL0kUrNjGQDmkumdzSXH7/f6wuTFDuwzZYPfogGX8RjZ/qpL5YpuHQNdVhxpbaSSQBJX4A+w8DgIwitpiYiK20j5XbS7QGx68YSdzaxrxWwKW12fwBd3jD2fZXfuymnxMnfhM1qoTKJjvU44H1nFn7Nk270sVsglupYfJy4c9qlp0SV1sE46Ci5+TKf6/VbY3YO2B/wdCAffMVokF9V+m/wd3mgZRBdRft9uEfdDU=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></soap:Body></soap:Envelope>
--------------------------------------
2018-12-20 23:06:54,471 INFO  [cxfConsumerToProcessorRoute] (default task-9) Received CXF Bean message: This is a simple request with Basic Auth and X509 signature+encrypt WS-Security policy activated!
2018-12-20 23:06:54,563 INFO  [org.apache.cxf.services.GreetingServiceService.greetingPort.greeting] (default task-9) Outbound Message
---------------------------
ID: 28
Response-Code: 200
Encoding: UTF-8
Content-Type: text/xml
Headers: {}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Header><wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" soap:mustUnderstand="1"><xenc:EncryptedKey xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference><ds:X509Data><ds:X509IssuerSerial><ds:X509IssuerName>CN=client-ws-x509signature</ds:X509IssuerName><ds:X509SerialNumber>335263260</ds:X509SerialNumber></ds:X509IssuerSerial></ds:X509Data></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>eulb/+vB0YFpejRhegVKnI5sp28rbEPaKWNH0KbKKoeRh/fE63aObZ6Wy1FBznQhC/n+9tTWwJFqzsjrEG7CEGuOsSeM1FrzlYw7C0CKu3S2oKs1MhY1CL+7UZkJ8vGAvO38i9cLQdZkfOUj81MFCZBqw1g+MgYFFlSirz6XzdlUZlzIl7bML3aKqfIkxR9U6MkB6XAatpVK5LiRr/sXtz6FAsb/8yyBVCp4hzapl6iu9ylDaA5Wi72AT4/yX3D6Q4317C+CMdvfDKY0q4X4kyYIzwsWciXadYok1YbY9ll1VZk2/rIeA7zXSCwuUxc4p0uACylThbb67/Nahwire1ija69XtzxZGU3BBu7qlCdQxnfNeQh1gmyItzwYOVPejFhacwX6/+4ZHLz1jc1tM3yOz41PeJBq4P5SxlcgvBx0gdEMFg1JmbuNKy0Rv6ABdNOJ+j8DJZQp3XWvKQxP+H7KKiK6wCsGiyjP/eUSZA95aoj8thlWyQuCIIR1Pe2sW2Yn4ruB5HTzDo4NFe3Oe6zvfMEb6rR7mPWZeQJcMWe1Z8Zkgs2bqNyXHqQD3KuXsMrfoaFTxbQS8DFrNIhT2VT1Z+X5u0dMaKOBOaQbOQsilaFNsnxCbV/ZlfRjuqSWrA7vytIyUcS8YfxiiL5fGN4+d2AGdQAidSe8BZgm8eE=</xenc:CipherValue></xenc:CipherData><xenc:ReferenceList><xenc:DataReference URI="#ED-f4770e27-bc56-4b91-ac26-749a649bbc26"/><xenc:DataReference URI="#ED-31c24d1e-3293-4025-9c11-31f3ba964c87"/></xenc:ReferenceList></xenc:EncryptedKey><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-f4770e27-bc56-4b91-ac26-749a649bbc26" Type="http://www.w3.org/2001/04/xmlenc#Element"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>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</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></wsse:Security></soap:Header><soap:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="id-6d1d12e3-dbb2-420d-a2d1-09de442925a1"><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-31c24d1e-3293-4025-9c11-31f3ba964c87" Type="http://www.w3.org/2001/04/xmlenc#Content"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>cZ1FEg+UEfhpxmbup1DZcv162+JtVCd4/ueLwtKPnJQdRIAdr+J6KiPukPSARdzazzVrz8WwhHL+Jp958YC7aDa/ZMiA/XXNg5DoM8qw3jQ9M3EPEcVc6As2TFuf5i96SlMXjwihAAaoBcxTksOORupMcROfssDC6LRcsByAmVyrF+f6Bbq1WNwm3r5LfJesz1CnwwxC4KmFGnlCkjvXSaeJ6ipyTDD5uKJMzrRiSuZvQjPiidckwGvZunz0w5Nizi6mNVynENxlti0WRq5ivfG713akbHZvFrkOCiA3BBw=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></soap:Body></soap:Envelope>
--------------------------------------
2018-12-20 23:06:54,573 INFO  [org.apache.cxf.services.GreetingServiceService.greetingPort.greeting] (default-workqueue-1) Inbound Message
----------------------------
ID: 27
Response-Code: 200
Encoding: UTF-8
Content-Type: text/xml;charset=UTF-8
Headers: {Cache-Control=[no-cache, no-store, must-revalidate], Connection=[keep-alive], Content-Type=[text/xml;charset=UTF-8], Date=[Thu, 20 Dec 2018 22:06:54 GMT], Expires=[0], Pragma=[no-cache], Server=[JBoss-EAP/7], Transfer-Encoding=[chunked], X-Powered-By=[Undertow/1]}
Payload: <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"><soap:Header><wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" soap:mustUnderstand="1"><xenc:EncryptedKey xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference><ds:X509Data><ds:X509IssuerSerial><ds:X509IssuerName>CN=client-ws-x509signature</ds:X509IssuerName><ds:X509SerialNumber>335263260</ds:X509SerialNumber></ds:X509IssuerSerial></ds:X509Data></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>eulb/+vB0YFpejRhegVKnI5sp28rbEPaKWNH0KbKKoeRh/fE63aObZ6Wy1FBznQhC/n+9tTWwJFqzsjrEG7CEGuOsSeM1FrzlYw7C0CKu3S2oKs1MhY1CL+7UZkJ8vGAvO38i9cLQdZkfOUj81MFCZBqw1g+MgYFFlSirz6XzdlUZlzIl7bML3aKqfIkxR9U6MkB6XAatpVK5LiRr/sXtz6FAsb/8yyBVCp4hzapl6iu9ylDaA5Wi72AT4/yX3D6Q4317C+CMdvfDKY0q4X4kyYIzwsWciXadYok1YbY9ll1VZk2/rIeA7zXSCwuUxc4p0uACylThbb67/Nahwire1ija69XtzxZGU3BBu7qlCdQxnfNeQh1gmyItzwYOVPejFhacwX6/+4ZHLz1jc1tM3yOz41PeJBq4P5SxlcgvBx0gdEMFg1JmbuNKy0Rv6ABdNOJ+j8DJZQp3XWvKQxP+H7KKiK6wCsGiyjP/eUSZA95aoj8thlWyQuCIIR1Pe2sW2Yn4ruB5HTzDo4NFe3Oe6zvfMEb6rR7mPWZeQJcMWe1Z8Zkgs2bqNyXHqQD3KuXsMrfoaFTxbQS8DFrNIhT2VT1Z+X5u0dMaKOBOaQbOQsilaFNsnxCbV/ZlfRjuqSWrA7vytIyUcS8YfxiiL5fGN4+d2AGdQAidSe8BZgm8eE=</xenc:CipherValue></xenc:CipherData><xenc:ReferenceList><xenc:DataReference URI="#ED-f4770e27-bc56-4b91-ac26-749a649bbc26"/><xenc:DataReference URI="#ED-31c24d1e-3293-4025-9c11-31f3ba964c87"/></xenc:ReferenceList></xenc:EncryptedKey><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-f4770e27-bc56-4b91-ac26-749a649bbc26" Type="http://www.w3.org/2001/04/xmlenc#Element"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>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</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></wsse:Security></soap:Header><soap:Body xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="id-6d1d12e3-dbb2-420d-a2d1-09de442925a1"><xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Id="ED-31c24d1e-3293-4025-9c11-31f3ba964c87" Type="http://www.w3.org/2001/04/xmlenc#Content"><xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"/><ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><wsse:SecurityTokenReference xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd" wsse11:TokenType="http://docs.oasis-open.org/wss/oasis-wss-soap-message-security-1.1#EncryptedKey"><wsse:Reference URI="#EK-acb1c918-24c7-4569-bbe8-67c4d77c0db1"/></wsse:SecurityTokenReference></ds:KeyInfo><xenc:CipherData><xenc:CipherValue>cZ1FEg+UEfhpxmbup1DZcv162+JtVCd4/ueLwtKPnJQdRIAdr+J6KiPukPSARdzazzVrz8WwhHL+Jp958YC7aDa/ZMiA/XXNg5DoM8qw3jQ9M3EPEcVc6As2TFuf5i96SlMXjwihAAaoBcxTksOORupMcROfssDC6LRcsByAmVyrF+f6Bbq1WNwm3r5LfJesz1CnwwxC4KmFGnlCkjvXSaeJ6ipyTDD5uKJMzrRiSuZvQjPiidckwGvZunz0w5Nizi6mNVynENxlti0WRq5ivfG713akbHZvFrkOCiA3BBw=</xenc:CipherValue></xenc:CipherData></xenc:EncryptedData></soap:Body></soap:Envelope>
--------------------------------------
2018-12-20 23:06:54,787 INFO  [directToCxfBeanRoute] (default-workqueue-1) Received SOAP response message: This is a simple request with Basic Auth and X509 signature+encrypt WS-Security policy activated! jEAN
```

SOAP-UI
-------

The service WSDL is available at _http://*<jboss\_eap\_host>*:8080/webservices/greeting-security-basic?wsdl_.

There is a single service operation named `greet` which takes 2 _String_ parameters named `message` and `name`. Invoking the web service will return a response where these values have been concatenated together.

Make sure the following outgoing and incoming **WS-security configurations** are enforced:
  * **Ecnryption Symmetric Encoding Algorithm**: `http://www.w3.org/2001/04/xmlenc#tripledes-cbc`
  * **Ecnryption Key Encryption Algorithm**: `http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p`
  * **Signature Algorithm**: `http://www.w3.org/2000/09/xmldsig#rsa-sha1`

![Rejected request without basic auth](../images/soapUIwithoutBasicAuth_KO.png)
![Rejected request with basic auth but no X509 signature/encryption](../images/soapUIwithBasicAuthAndNoX509Sign_KO.png)


## Undeploy

1. To undeploy the example run `mvn clean -Pdeploy`.

2. Unconfigure the example tls security configuration:

    For Linux:

    `${JBOSS_HOME}/bin/jboss-cli.sh --connect --file=remove-basic-security.cli`

    For Windows:

    `%JBOSS_HOME%\bin\jboss-cli.bat --connect --file=remove-basic-security.cli`
